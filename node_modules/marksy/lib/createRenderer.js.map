{"version":3,"sources":["../src/createRenderer.js"],"names":["createRenderer","tracker","options","overrides","renderer","Renderer","getTocPosition","toc","level","currentLevel","children","length","populateInlineContent","content","contentArray","split","extractedElements","map","text","elementIdMatch","match","tree","splice","indexOf","elements","decode","addElement","tag","props","elementId","nextElementId","inlineContent","Array","isArray","createElement","Object","assign","key","push","code","language","CodeComponent","__html","highlight","highlightAuto","value","html","dangerouslySetInnerHTML","paragraph","blockquote","link","href","title","br","hr","strong","del","em","heading","id","replace","toLowerCase","lastToc","tocPosition","list","body","ordered","listitem","table","header","thead","tbody","tablerow","tablecell","flag","className","align","undefined","codespan","image","src","alt"],"mappings":"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","file":"createRenderer.js","sourcesContent":["import React from 'react';\nimport marked from 'marked';\nimport he from 'he';\n\nexport default function createRenderer (tracker, options, overrides = {}) {\n  const renderer = new marked.Renderer();\n\n  function getTocPosition (toc, level) {\n    var currentLevel = toc.children;\n    while (true) {\n      if (!currentLevel.length || currentLevel[currentLevel.length - 1].level === level) {\n        return currentLevel;\n      } else {\n        currentLevel = currentLevel[currentLevel.length - 1].children;\n      }\n    }\n  }\n\n  function populateInlineContent (content = '') {\n    const contentArray = content.split(/(\\{\\{.*?\\}\\})/);\n    const extractedElements = contentArray.map(function (text) {\n      const elementIdMatch = text.match(/\\{\\{(.*)\\}\\}/);\n      if (elementIdMatch) {\n        tracker.tree.splice(tracker.tree.indexOf(tracker.elements[elementIdMatch[1]]), 1)\n        return tracker.elements[elementIdMatch[1]];\n      } else if (text != '') {\n        return he.decode(text);\n      }\n\n      return null;\n    });\n\n    return extractedElements;\n  }\n\n  function addElement (tag, props = {}, children) {\n    const elementId = tracker.nextElementId++;\n    let inlineContent = null;\n\n    if (children) {\n      inlineContent = Array.isArray(children) ? children.map(populateInlineContent) : populateInlineContent(children)\n    }\n\n    tracker.elements[elementId] = React.createElement(options[tag] || tag, Object.assign({\n      key: elementId\n    }, props), inlineContent);\n\n    tracker.tree.push(tracker.elements[elementId]);\n\n    return `{{${elementId}}}`;\n  }\n\n  renderer.code = overrides.code || function (code, language) {\n    const elementId = tracker.nextElementId++;\n\n    function CodeComponent () {\n      return <pre><code className={`hljs ${language}`} dangerouslySetInnerHTML={{__html: options.highlight ? options.highlight.highlightAuto(code).value : code}}></code></pre>\n    }\n\n    tracker.elements[elementId] = React.createElement(CodeComponent, {key: elementId});\n\n    tracker.tree.push(tracker.elements[elementId]);\n\n    return `{{${elementId}}}`;\n  };\n\n  renderer.html = overrides.html || function (html) {\n    const elementId = tracker.nextElementId++;\n\n    tracker.tree.push(React.createElement('div', {\n      key: elementId,\n      dangerouslySetInnerHTML: {\n        __html: html\n      }\n    }))\n  };\n\n  renderer.paragraph = overrides.paragraph || function (text) {\n    return addElement('p', null, text);\n  }\n\n  renderer.blockquote = overrides.blockquote || function (text) {\n    return addElement('blockquote', null, text);\n  }\n\n  renderer.link = overrides.link || function (href, title, text) {\n    return addElement('a', {href, title}, text);\n  }\n\n  renderer.br = overrides.br || function () {\n    return addElement('br');\n  }\n\n  renderer.hr = overrides.hr || function () {\n    return addElement('hr');\n  }\n\n  renderer.strong = overrides.strong || function (text) {\n    return addElement('strong', null, text);\n  }\n\n  renderer.del = overrides.del || function (text) {\n    return addElement('del', null, text);\n  }\n\n  renderer.em = overrides.em || function (text) {\n    return addElement('em', null, text);\n  }\n\n  renderer.heading = overrides.heading || function (text, level) {\n    const id = text.replace(/\\s/g, '-').toLowerCase();\n    const lastToc = tracker.toc[tracker.toc.length - 1];\n\n    if (!lastToc || lastToc.level > level) {\n      tracker.toc.push({\n        id: id,\n        title: text,\n        level: level,\n        children: []\n      });\n    } else {\n      const tocPosition = getTocPosition(lastToc, level);\n\n      tocPosition.push({\n        id: id,\n        title: text,\n        level: level,\n        children: []\n      });\n    }\n\n    return addElement(`h${level}`, {\n      id\n    }, text);\n  }\n\n  renderer.list = overrides.list || function (body, ordered) {\n    return addElement(ordered ? 'ol' : 'ul', null, body);\n  }\n\n  renderer.listitem = overrides.listitem || function (text) {\n    return addElement('li', null, text);\n  }\n\n  renderer.table = overrides.table || function (header, body) {\n    return addElement('table', null, [\n      addElement('thead', null, header),\n      addElement('tbody', null, body)\n    ]);\n  }\n\n  renderer.thead = overrides.thead || function (content) {\n    return addElement('thead', null, content)\n  }\n\n  renderer.tbody = overrides.tbody || function (content) {\n    return addElement('tbody', null, content)\n  }\n\n  renderer.tablerow = overrides.tablerow || function (content) {\n    return addElement('tr', null, content)\n  }\n\n  renderer.tablecell = overrides.tablecell || function (content, flag) {\n    const tag = flag.header ? 'th' : 'td'\n    return addElement(tag, {className: flag.align ? `text-${flag.align}` : undefined}, content)\n  }\n\n  renderer.codespan = overrides.codespan || function (text) {\n    return addElement('code', null, text)\n  }\n\n  renderer.image = overrides.image || function (href, title, text) {\n    return addElement('img', {src: href, alt: text})\n  }\n\n  return renderer;\n}\n"]}